<mat-card>
  <mat-card-title>Create new message</mat-card-title>
  <mat-card-content>
    <form [formGroup]="form" #formDirective="ngForm" (ngSubmit)="send()">
      <p>
        <mat-label>Recipients</mat-label>
        <mat-chip-list #chipList>
          <mat-chip
            *ngFor="let user of recipients"
            [selectable]="true"
            (removed)="removeRecipient(user)"
          >
            {{ user }}
            <mat-icon matChipRemove>cancel</mat-icon>
          </mat-chip>

          <input
            #chipInput
            placeholder="Add recipient"
            formControlName="recipient"
            [matAutocomplete]="chipAutocomplete"
            [matChipInputFor]="chipList"
            (matChipInputTokenEnd)="addRecipient($event)"
          />
        </mat-chip-list>

        <mat-autocomplete
          #chipAutocomplete="matAutocomplete"
          (optionSelected)="selectedRecipient($event)"
        >
          <mat-option *ngFor="let user of filteredUsers | async" [value]="user">
            {{ user }}
          </mat-option>
        </mat-autocomplete>
      </p>
      <p>
        <mat-form-field>
          <input
            matInput
            placeholder="Subject"
            formControlName="subject"
            required
          />
        </mat-form-field>
      </p>
      <p>
        <mat-form-field>
          <textarea
            matInput
            placeholder="Message"
            formControlName="message"
            cdkTextareaAutosize
            required
          ></textarea>
        </mat-form-field>
      </p>
      <div class="button">
        <button type="submit" mat-button [disabled]="form.invalid">Send</button>
      </div>
    </form>
  </mat-card-content>
</mat-card>
